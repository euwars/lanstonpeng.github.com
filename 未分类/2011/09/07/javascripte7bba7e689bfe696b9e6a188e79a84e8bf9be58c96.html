<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>javascript继承方案的进化</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Lanston Peng's ideas</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>javascript继承方案的进化</h2>
<p class="meta">07 Sep 2011</p>

<div class="post">
<p>在javascript中，继承是一个颇为热门的话题</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">var Human=function(name,age){
    this.name=name;
    this.age=age;
}
Human.prototype.sayName=function(){ console.log(this.name); }
</code></pre></div>
<p>然后，我们让一个对象继承Human</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">var lanston=function(name,age){
    Human.call(this,name,age);
    this.isVeryBad=true;
}
lanston.prototype=new Human();
var check=new lanston(&quot;lanstonpeng&quot;,21);
check.name==&quot;lanstonpeng&quot;;
check.sayName(); //lanstonpeng
</code></pre></div>
<p>虽然这种方式比较常见，但是却存在一点效率问题：
因为其两次调用了Human
在这种情况下，实际上在 lanston 中与lanston.prototype 中都存在name,age
一个name，age是在new Human()时创建的
另一个是在Human.call时创建的</p>

<p>通过翻阅了一些资料，发现了一种比较好的办法，就是取消 new Human() 这一步，用一下方法来替代
&lt;!-- more --&gt;</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">function beget(obj){
    var f=function(){};
    f.prototype=obj;
    return new f();
}
function extend(Super,Sub){
   Sub.prototype=beget(Super.prototype);
}
</code></pre></div>
<p>稍微分析一下代码，beget函数其实就是新建一个对象，起原型指向我们指定的那个需要被继承的父对象（即代码中的obj),
我相信看过The good parts 的朋友肯定对这个函数名有印象
至于我们一开始需要</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">lanston.prototype=new Human()
</code></pre></div>
<p>无非是想继承<strong>Human</strong>的方法，但是带来的弊端就是多余的属性，这里就是name跟age了,
我们只需要在<strong>lanston</strong>上需要name跟age，不需要在其prototype上面拥有这些属性，我们要的
仅仅是方法而已
至于extend方法就是为了解决这个问题的，beget函数在上面已经说明了，其它的也不难理解
所以，用同样的方法，将上面的代码改改</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">extend(Human,lanston)
</code></pre></div>
<p>ref--&gt;
<a href="http://www.crockford.com/javascript/inheritance.html">Classical Inheritance in JavaScript</a>
<a href="http://javascript.crockford.com/prototypal.html">Prototypal Inheritance in JavaScript</a></p>

</div>


          <div class="footer">
            <div class="contact">
              <p>
                Lanston Peng<br />
                Life Hacker<br />
                lanstonpeng[AT]gmail.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="http://www.douban.com/people/lanstonpeng/">豆瓣</a><br />
                <a href="https://github.com/lanstonpeng">github.com/lanstonpeng</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
